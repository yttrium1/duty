<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Calendar Selection</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    body {
      font-family: 'Noto Sans JP', sans-serif;
    }
    .date:hover {
      cursor: pointer;
      background-color: #fbd38d;
    }
    .calendar-day {
      font-weight: bold;
    }
    .calendar-day-sun {
      color: red;
    }
    .calendar-day-sat {
      color: blue;
    }
    .step-button {
      display: inline-block;
      background-color: #68d391;
      color: white;
      font-weight: bold;
      padding: 8px 16px;
      border-radius: 9999px;
      margin-bottom: 8px;
    }
    #generate-url {
      display: inline-block;
      background-color: #f6e05e;
      color: white;
      font-weight: bold;
      padding: 8px 16px;
      border-radius: 9999px;
      margin-bottom: 8px;
    }
  </style>
</head>
<body class="bg-gray-100">
  <div class="max-w-screen-md mx-auto py-10">
    <div class="text-right mb-4">
      <span class="text-lg font-semibold">内科当直</span>
    </div>

    <div class="mb-8">
      <span class="step-button">STEP 1</span>
      <select id="name-select" class="mt-2 p-2 border border-gray-300 rounded w-full">
        <option value="">回答者の名前を選択してください</option>
        <option value="西中川">西中川</option>
        <option value="大場">大場</option>
        <option value="乾山">乾山</option>
        <option value="荻野">荻野</option>
        <option value="高橋（伸）">高橋（伸）</option>
        <option value="渡辺（浩）">渡辺（浩）</option>
        <option value="折原">折原</option>
        <option value="池上">池上</option>
        <option value="中島">中島</option>
        <option value="河野">河野</option>
        <option value="松村">松村</option>
        <option value="伊藤">伊藤</option>
        <option value="堂脇">堂脇</option>
        <option value="古賀">古賀</option>
        <option value="吉玉">吉玉</option>
        <option value="浅原">浅原</option>
        <option value="高亀">高亀</option>
        <option value="中村">中村</option>
        <option value="久次米">久次米</option>
        <option value="その他">その他</option>
      </select>
      <input id="other-name-input" type="text" placeholder="名前を入力" class="mt-2 p-2 border border-gray-300 rounded w-full" style="display:none;">
    </div>

    <div class="mb-8">
      <span class="step-button">STEP 2</span>
      <p class="text-gray-700 text-sm mt-2">希望日を選択してください</p>
      <div class="mt-2 p-4 border border-gray-300 rounded preferred bg-white">
        <!-- Calendar will be dynamically generated here -->
      </div>
    </div>

    <div class="mb-8">
      <span class="step-button">STEP 3</span>
      <p class="text-gray-700 text-sm mt-2">希望しない日を選択してください（翌日外来・外勤のためできない日も含む）</p>
      <div class="mt-2 p-4 border border-gray-300 rounded not-preferred bg-white">
        <!-- Calendar will be dynamically generated here -->
      </div>
    </div>

    <div class="mb-8">
      <span class="step-button">STEP 4</span>
      <p class="text-gray-700 text-sm mt-2">コメントを追加してください（任意）</p>
      <textarea id="comment-input" class="mt-2 p-2 border border-gray-300 rounded w-full" placeholder="コメント"></textarea>
    </div>

    <button id="generate-url" class="bg-green-600 text-white font-bold py-2 px-4 rounded-full">送信する</button>
  </div>

  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>
  <script type="text/javascript">
    (function(){
      emailjs.init("rosai041321@gmail.com");
    })();
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Existing code for calendar and other initializations...

      document.getElementById('name-select').addEventListener('change', function() {
        if (this.value === 'その他') {
          document.getElementById('other-name-input').style.display = '';
        } else {
          document.getElementById('other-name-input').style.display = 'none';
        }
      });

      document.getElementById('generate-url').addEventListener('click', function(event) {
        event.preventDefault();

        // Collect form data
        const nameSelect = document.getElementById('name-select');
        let name = nameSelect.value;
        if (name === 'その他') {
          name = document.getElementById('other-name-input').value;
        }
        const comment = document.getElementById('comment-input').value;
        // Add your code to collect preferred and not preferred dates

        // Send email via EmailJS
        emailjs.send("service_1d6zngh", "template_rm69kao", {
          // Add your template parameters here
        }).then(function(response) {
          console.log('SUCCESS!', response.status, response.text);
        }, function(error) {
          console.log('FAILED...', error);
        });
      });
    });
  </script>
</body>
</html>
